<!DOCTYPE html>
<html lang="zh-TW">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>é™æ™‚æ¶è³¼ç³»çµ±</title>
  <style>
    body { font-family: "Microsoft JhengHei", sans-serif; background: #f4f4f9; display: flex; justify-content: center; align-items: center; height: 100vh; margin: 0; }
    .card { background: white; padding: 30px; border-radius: 10px; box-shadow: 0 5px 15px rgba(0,0,0,0.1); width: 100%; max-width: 400px; text-align: center; }
    .hidden { display: none; }
    input { width: 100%; padding: 12px; margin: 10px 0; box-sizing: border-box; border: 1px solid #ccc; border-radius: 5px; }
    button { width: 100%; padding: 12px; border: none; border-radius: 5px; cursor: pointer; font-size: 16px; font-weight: bold; margin-top: 10px; }
    .btn-login { background: #333; color: white; }
    .btn-grab { background: #d32f2f; color: white; font-size: 18px; }
    .btn-grab:disabled { background: #ccc; }
    .btn-reset { background: #e0e0e0; color: #333; margin-top: 20px; font-size: 14px; }
    #msg { margin-top: 15px; font-weight: bold; min-height: 20px; }
    .error { color: red; } .success { color: green; }
  </style>
</head>
<body>

  <div id="login-area" class="card">
    <h2>ğŸ”’ ç³»çµ±é–å®š</h2>
    <p>è«‹è¼¸å…¥ç®¡ç†å“¡å¯†ç¢¼</p>
    <input type="password" id="passInput" placeholder="Password">
    <button class="btn-login" onclick="checkPass()">é€²å…¥ç³»çµ±</button>
    <p id="login-msg" class="error"></p>
  </div>

  <div id="app-area" class="card hidden">
    <h2>ğŸš€ é™æ™‚æ¶è³¼æ¸¬è©¦</h2>
    <input type="text" id="username" placeholder="è«‹è¼¸å…¥æ¸¬è©¦è€…åç¨± (ä¾‹: Ykk)">
    <button id="grabBtn" class="btn-grab" onclick="sendData()">ç«‹å³æ¶è³¼</button>
    <div id="msg"></div>
    
    <hr style="margin: 20px 0; border: 0; border-top: 1px solid #eee;">
    <button class="btn-reset" onclick="resetTest()">ğŸ”„ æ¸…é™¤é‡å¡« (æ›äººæ¸¬è©¦)</button>
  </div>

<script>
  // ==========================================
  // ğŸ”´ è«‹æŠŠå‰›å‰›çš„ç¶²å€è²¼åœ¨å¼•è™Ÿè£¡é¢ ğŸ”´
  // ==========================================
  const SCRIPT_URL = "https://script.google.com/macros/s/AKfycbwBSR9AjURmytbz9MTRYw3rlfzY1TMs_Uni1yQ5tDxExVHiEih8X4EI8SbYCmIb8GV1yQ/exec";

  function checkPass() {
    if (document.getElementById("passInput").value === "ykk8880820") {
      document.getElementById("login-area").classList.add("hidden");
      document.getElementById("app-area").classList.remove("hidden");
    } else {
      document.getElementById("login-msg").innerText = "å¯†ç¢¼éŒ¯èª¤";
    }
  }

  function sendData() {
    var user = document.getElementById("username").value;
    var btn = document.getElementById("grabBtn");
    var msg = document.getElementById("msg");

    if (!user) { alert("è«‹è¼¸å…¥åå­—"); return; }

    btn.disabled = true; 
    btn.innerText = "è™•ç†ä¸­...";
    msg.innerText = "";

    fetch(SCRIPT_URL, {
      method: "POST",
      body: JSON.stringify({ user: user, item: "é™é‡å•†å“" })
    })
    .then(r => r.json())
    .then(data => {
      msg.innerText = data.message;
      msg.className = (data.result === "success") ? "success" : "error";
      alert(data.message);
    })
    .catch(e => { msg.innerText = "é€£ç·šå¤±æ•—"; console.error(e); })
    .finally(() => {
      btn.disabled = false;
      btn.innerText = "ç«‹å³æ¶è³¼";
    });
  }

  function resetTest() {
    document.getElementById("username").value = "";
    document.getElementById("msg").innerText = "";
  }
</script>
</body>
</html>